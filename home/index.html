<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Success AI | Master Control v3.1</title>
    <style>
        /* TERMINAL AESTHETIC */
        body { 
            background: #050505; 
            color: #00ff41; 
            font-family: 'Courier New', monospace; 
            margin: 0; 
            padding: 20px; 
            display: flex; 
            justify-content: center;
        }
        .panel { 
            width: 100%; 
            max-width: 500px; 
            border: 1px solid #00ff41; 
            padding: 20px; 
            box-shadow: 0 0 15px rgba(0, 255, 65, 0.2); 
        }
        h2 { 
            text-align: center; 
            text-transform: uppercase; 
            border-bottom: 1px solid #00ff41; 
            padding-bottom: 10px; 
            margin-top: 0;
            letter-spacing: 2px;
        }

        /* TELEMETRY BAR */
        .stats-bar { 
            display: flex; 
            justify-content: space-between; 
            background: #111; 
            padding: 10px; 
            margin-bottom: 20px; 
            font-size: 12px;
            border: 1px dashed #333;
        }
        .stat-val { color: #fff; font-weight: bold; }

        /* INPUT STYLING */
        section { margin-bottom: 25px; }
        label { display: block; font-size: 10px; margin-bottom: 5px; color: #008f11; }
        input { 
            width: 100%; 
            background: #000; 
            border: 1px solid #00ff41; 
            color: #00ff41; 
            padding: 10px; 
            box-sizing: border-box; 
            outline: none; 
            margin-bottom: 10px;
        }
        input:focus { border-color: #fff; box-shadow: 0 0 5px #fff; }

        /* BUTTONS */
        .btn-row { display: flex; gap: 5px; }
        button { 
            flex: 1;
            background: #002200; 
            color: #00ff41; 
            border: 1px solid #00ff41; 
            padding: 10px; 
            cursor: pointer; 
            font-size: 11px; 
            text-transform: uppercase;
        }
        button:hover { background: #00ff41; color: #000; }
        button:active { background: #fff; border-color: #fff; }

        /* VIRTUAL REMOTE GRID */
        .remote-grid { 
            display: grid; 
            grid-template-columns: repeat(3, 1fr); 
            gap: 8px; 
            width: 220px; 
            margin: 0 auto; 
        }
        .nav-btn { padding: 15px 5px; }

        .status-log { 
            font-size: 10px; 
            color: #444; 
            text-align: center; 
            margin-top: 10px; 
            height: 15px;
        }
    </style>
</head>
<body>

<div class="panel">
    <h2>[ BIGFISH_NODE: <span id="ip">OFFLINE</span> ]</h2>

    <!-- REAL-TIME TELEMETRY -->
    <div class="stats-bar">
        <div>CPU: <span id="cpu" class="stat-val">0</span>%</div>
        <div>RAM: <span id="ram" class="stat-val">0</span>%</div>
        <div>UP: <span id="up" class="stat-val">0</span>m</div>
    </div>

    <!-- AI BRAIN INTERFACE -->
    <section>
        <label>> GEMINI INTELLIGENCE ROUTER (NATURAL LANGUAGE)</label>
        <input id="ai_in" type="text" placeholder="e.g. 'Go home and tell me the time'" onkeypress="if(event.key==='Enter') executeAI()">
        <button style="width:100%" onclick="executeAI()">SEND_TO_BRAIN</button>
    </section>

    <!-- MANUAL VOICE TRIGGER -->
    <section>
        <label>> DIRECT TEXT-TO-SPEECH (RHVOICE)</label>
        <div class="btn-row">
            <input id="tts_in" type="text" placeholder="Type to speak..." style="margin-bottom:0">
            <button onclick="executeSpeak()" style="flex:0.3">SPEAK</button>
        </div>
    </section>

    <!-- VIRTUAL REMOTE (Bypasses lost physical remote) -->
    <section>
        <label style="text-align:center">> VIRTUAL NAVIGATION OVERRIDE</label>
        <div class="remote-grid">
            <div></div> 
            <button class="nav-btn" onclick="sendNav(19)">UP</button> 
            <div></div>
            
            <button class="nav-btn" onclick="sendNav(21)">LEFT</button>
            <button class="nav-btn" style="background:#004400" onclick="sendNav(66)">OK</button>
            <button class="nav-btn" onclick="sendNav(22)">RIGHT</button>
            
            <div></div> 
            <button class="nav-btn" onclick="sendNav(20)">DOWN</button> 
            <div></div>

            <button onclick="sendNav(3)">HOME</button>
            <button onclick="sendNav(4)" style="grid-column: span 2">BACK</button>
        </div>
    </section>

    <!-- MEDIA CONTROLS -->
    <section>
        <label style="text-align:center">> MEDIA & VOLUME</label>
        <div class="btn-row">
            <button onclick="sendNav(24)">VOL +</button>
            <button onclick="sendNav(25)">VOL -</button>
            <button onclick="sendNav(164)">MUTE</button>
            <button onclick="sendNav(85)">PLAY/PAUSE</button>
        </div>
    </section>

    <!-- SYSTEM CONTROLS -->
    <section>
        <label style="text-align:center">> SYSTEM KERNEL</label>
        <button onclick="restartBridge()" style="background:#550000; color:#ff4444; border-color:#ff4444; width:100%">EMERGENCY RESTART</button>
    </section>

    <div id="log" class="status-log">System Standing By...</div>
</div>

<!-- Firebase Logic -->
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>

<script>
    // 1. FIREBASE INITIALIZATION
    const firebaseConfig = {
        apiKey: "AIzaSyA6sANvYoAkXHYG8MjbZl6Pyq23CNdBuzA",
        databaseURL: "https://community-canvas-255fa-default-rtdb.firebaseio.com",
        projectId: "community-canvas-255fa",
    };

    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    // 2. ACTION FUNCTIONS
    function executeAI() {
        const p = document.getElementById('ai_in').value;
        if(!p) return;
        pushCmd({ type: 'ai', prompt: p });
        document.getElementById('ai_in').value = "";
        updateLog("AI Prompt Dispatched...");
    }

    function executeSpeak() {
        const t = document.getElementById('tts_in').value;
        if(!t) return;
        pushCmd({ type: 'speak', text: t });
        document.getElementById('tts_in').value = "";
        updateLog("Speech Command Dispatched...");
    }

    function sendNav(code) {
        pushCmd({ type: 'nav', key: code });
        updateLog("KeyEvent " + code + " Dispatched...");
    }

    function restartBridge() {
        if(confirm("CONFIRM KERNEL REBOOT?")) {
            db.ref('home_system/control/restart').set(true);
            updateLog("REBOOT SIGNAL SENT...");
        }
    }

    // 3. DATABASE PUSH ENGINE
    function pushCmd(payload) {
        // Path matches the bridge.py listener
        db.ref('home_system/commands').set(payload)
          .catch(e => updateLog("CRITICAL_ERROR: " + e.message));
    }

    function updateLog(msg) {
        const l = document.getElementById('log');
        l.innerText = ">> " + msg;
        setTimeout(() => { l.innerText = "System Standing By..."; }, 3000);
    }

    // 4. REAL-TIME TELEMETRY LISTENER
    db.ref('home_system/server_info').on('value', (snapshot) => {
        const data = snapshot.val();
        if(!data) return;
        
        document.getElementById('ip').innerText = data.ip || "UNKNOWN";
        document.getElementById('cpu').innerText = data.cpu || "0";
        document.getElementById('ram').innerText = data.ram || "0";
        document.getElementById('up').innerText = data.uptime_m || "0";
    });
</script>

</body>
</html>
