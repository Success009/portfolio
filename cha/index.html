<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Access Notice</title>
<style>
*{margin:0;padding:0;box-sizing:border-box}
body{
  font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,sans-serif;
  background:#f0f2f5;
  height:100vh;
  overflow:hidden
}

/* Intruder / Notice Screen */
.intruder{
  background:linear-gradient(135deg,#ff6b6b,#ff3737,#ee5a52);
  color:#fff;
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center;
  height:100vh;
  padding:40px;
  text-align:center;
  position:relative;
  overflow:hidden
}
.intruder::before{
  content:'';
  position:absolute;
  top:0;left:0;right:0;bottom:0;
  background:url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><defs><pattern id="grain" width="100" height="100" patternUnits="userSpaceOnUse"><circle cx="20" cy="20" r="1" fill="rgba(255,255,255,0.1)"/><circle cx="80" cy="80" r="1" fill="rgba(255,255,255,0.05)"/><circle cx="40" cy="60" r="0.5" fill="rgba(255,255,255,0.08)"/></pattern></defs><rect width="100" height="100" fill="url(%23grain)"/></svg>');
  opacity:0.3;
  animation:float 20s ease-in-out infinite
}
.intruder-icon{
  font-size:80px;
  margin-bottom:30px;
  animation:pulse 2s ease-in-out infinite;
  z-index:1
}
.intruder-title{
  font-size:32px;
  font-weight:800;
  margin-bottom:15px;
  text-shadow:0 4px 20px rgba(0,0,0,0.3);
  z-index:1
}
.intruder-subtitle{
  font-size:18px;
  opacity:0.9;
  font-weight:300;
  letter-spacing:0.5px;
  z-index:1
}

@keyframes pulse{0%,100%{transform:scale(1)}50%{transform:scale(1.1)}}
@keyframes float{0%,100%{transform:translateY(0)}50%{transform:translateY(-20px)}}

@media(max-width:480px){
  .intruder-title{font-size:28px}
  .intruder-subtitle{font-size:16px}
}
</style>
</head>
<body>
<div id="app"></div>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>
<script>
const cfg={
  apiKey:"AIzaSyA6sANvYoAkXHYG8MjbZl6Pyq23CNdBuzA",
  authDomain:"community-canvas-255fa.firebaseapp.com",
  databaseURL:"https://community-canvas-255fa-default-rtdb.firebaseio.com",
  projectId:"community-canvas-255fa",
  storageBucket:"community-canvas-255fa.appspot.com",
  messagingSenderId:"729445267995",
  appId:"1:729445267995:web:05da6756d66c58b9ccd6be",
  measurementId:"G-FW93CB5QL7"
};
firebase.initializeApp(cfg);
const db=firebase.database();
const app=document.getElementById('app');

/* --- Main Display --- */
function showIntruderScreen(){
  app.innerHTML=`
    <div class="intruder">
      <div class="intruder-icon">⚠️</div>
      <div class="intruder-title">Unauthorized Access Detected</div>
      <div class="intruder-subtitle">Your visit has been recorded for security purposes.</div>
    </div>`;
}

/* --- Record Intruder Information --- */
async function recordIntruder(){
  try {
    const info={
      userAgent:navigator.userAgent,
      language:navigator.language,
      platform:navigator.platform,
      timezone:Intl.DateTimeFormat().resolvedOptions().timeZone,
      screen:`${screen.width}x${screen.height}`,
      timestamp:new Date().toISOString(),
      token:localStorage.getItem('deviceToken') || 'unknown',
    };
    await db.ref('intruders').push(info);
  } catch(e){
    console.error('Intruder log failed:', e);
  }
}

/* --- Ensure Structure Exists --- */
async function ensureStructure(){
  try{
    const ref=db.ref('chatting');
    const snap=await ref.once('value');
    if(!snap.exists()){
      await ref.set({
        Token:"device_bnnkklkcm34_1756732674868",
        messages:{user:{},success:{}}
      });
    }
  }catch(e){console.error('Setup failed:',e);}
}

document.addEventListener('DOMContentLoaded',()=>{
  ensureStructure();
  recordIntruder();
  showIntruderScreen();
});
</script>
</body>
</html>
